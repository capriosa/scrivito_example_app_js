!function(){function getVideoId(e){if("false"==e)return!1;var t=/(?:\?v=|\/embed\/|\.be\/)([-a-z0-9_]+)/i.exec(e)||/^([-a-z0-9_]+)$/i.exec(e);return t?t[1]:!1}function getPreviewUrl(e,t){return"http://img.youtube.com/vi/"+e+"/"+(t||"")+"default.jpg"}var getPreviewUrlWithBestQuality=function(){var e={};return function(t){var i=$.Deferred();return t in e?e[t]?i.resolve(e[t]):i.reject("Preview image not found."):$("<img>").on("load",function(){if(120==(this.naturalWidth||this.width)){var n=this.src.split("/").pop();switch(n){case"maxresdefault.jpg":this.src=this.src.replace(n,"sddefault.jpg");break;case"sddefault.jpg":this.src=this.src.replace(n,"hqdefault.jpg");break;case"hqdefault.jpg":this.src=this.src.replace(n,"default.jpg");break;default:e[t]=null,i.reject("Preview image not found.")}}else i.resolve(e[t]=this.src)}).attr("src",getPreviewUrl(t,"maxres")),i}}();$(document).on("add.cards change.cards",function(event){if($(event.target).hasClass("mbr-slider")){var isInit="add"==event.type,isDesktop=$("html").hasClass("desktop"),isBuilder=$("html").hasClass("is-builder");$(event.target).outerFind("[data-bg-video-slide]").each(function(){isInit||$(".mbr-background-video-preview",this).remove();var videoId=getVideoId($(this).attr("data-bg-video-slide"));if(videoId){var $preview=$('<div class="mbr-background-video-preview"></div>').css({display:"none",backgroundSize:"cover",backgroundPosition:"center"});if($(".mbr-overlay, .container-slide",this).before($preview),getPreviewUrlWithBestQuality(videoId).done(function(e){$preview.css("background-image",'url("'+e+'")').show()}),isInit&&isDesktop&&!isBuilder&&$.fn.YTPlayer&&!$(this).find(".playerBox").length){var params=eval("("+($(this).attr("data-bg-video-slide-params")||"{}")+")");$(".container-slide",this).before('<div class="mbr-background-video"></div>').prev().YTPlayer($.extend({videoURL:videoId,containment:"self",showControls:!1,mute:!0},params));var $overlay=$(this).find(".mbr-overlay");$overlay.length&&$(".YTPOverlay",this).css({opacity:$overlay.css("opacity"),backgroundColor:$overlay.css("background-color")})}}}),isInit&&($(this).on("slide.bs.carousel","section.mbr-slider",function(e){$(e.target).find(".carousel-item.active .mb_YTPlayer").each(function(){$(this).YTPPause()}),$(e.target).find(".carousel-item:not(.active) iframe").css("opacity",0)}),$(this).on("slid.bs.carousel","section.mbr-slider",function(e){$(e.target).find(".carousel-item.active .mb_YTPlayer").each(function(){$(this).YTPPlay()}),$(e.target).find(".carousel-item.active iframe").resize().css("opacity",1)}))}})}();
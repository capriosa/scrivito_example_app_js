/*! lightgallery - v1.2.21 - 2016-06-28
* http://sachinchoolur.github.io/lightGallery/
* Copyright (c) 2016 Sachin N; Licensed Apache 2.0 */
!function(e,t){"use strict";var i={scale:1,zoom:!0,actualSize:!0,enableZoomAfter:300},n=function(n){return this.core=e(n).data("lightGallery"),this.core.s=e.extend({},i,this.core.s),this.core.s.zoom&&this.core.doCss()&&(this.init(),this.zoomabletimeout=!1,this.pageX=e(t).width()/2,this.pageY=e(t).height()/2+e(t).scrollTop()),this};n.prototype.init=function(){var i=this,n='<span id="lg-zoom-in" class="lg-icon"></span><span id="lg-zoom-out" class="lg-icon"></span>';i.core.s.actualSize&&(n+='<span id="lg-actual-size" class="lg-icon"></span>'),this.core.$outer.find(".lg-toolbar").append(n),i.core.$el.on("onSlideItemLoad.lg.tm.zoom",function(t,n,o){var r=i.core.s.enableZoomAfter+o;e("body").hasClass("lg-from-hash")&&o?r=0:e("body").removeClass("lg-from-hash"),i.zoomabletimeout=setTimeout(function(){i.core.$slide.eq(n).addClass("lg-zoomable")},r+30)});var o=1,r=function(n){var o,r,s=i.core.$outer.find(".lg-current .lg-image"),a=(e(t).width()-s.width())/2,l=(e(t).height()-s.height())/2+e(t).scrollTop();o=i.pageX-a,r=i.pageY-l;var c=(n-1)*o,u=(n-1)*r;s.css("transform","scale3d("+n+", "+n+", 1)").attr("data-scale",n),s.parent().css({left:-c+"px",top:-u+"px"}).attr("data-x",c).attr("data-y",u)},s=function(){o>1?i.core.$outer.addClass("lg-zoomed"):i.resetZoom(),1>o&&(o=1),r(o)},a=function(n,r,a,l){var c,u=r.width();c=i.core.s.dynamic?i.core.s.dynamicEl[a].width||r[0].naturalWidth||u:i.core.$items.eq(a).attr("data-width")||r[0].naturalWidth||u;var d;i.core.$outer.hasClass("lg-zoomed")?o=1:c>u&&(d=c/u,o=d||2),l?(i.pageX=e(t).width()/2,i.pageY=e(t).height()/2+e(t).scrollTop()):(i.pageX=n.pageX||n.originalEvent.targetTouches[0].pageX,i.pageY=n.pageY||n.originalEvent.targetTouches[0].pageY),s(),setTimeout(function(){i.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")},10)},l=!1;i.core.$el.on("onAferAppendSlide.lg.tm.zoom",function(e,t){var n=i.core.$slide.eq(t).find(".lg-image");n.on("dblclick",function(e){a(e,n,t)}),n.on("touchstart",function(e){l?(clearTimeout(l),l=null,a(e,n,t)):l=setTimeout(function(){l=null},300),e.preventDefault()})}),e(t).on("resize.lg.zoom scroll.lg.zoom orientationchange.lg.zoom",function(){i.pageX=e(t).width()/2,i.pageY=e(t).height()/2+e(t).scrollTop(),r(o)}),e("#lg-zoom-out").on("click.lg",function(){i.core.$outer.find(".lg-current .lg-image").length&&(o-=i.core.s.scale,s())}),e("#lg-zoom-in").on("click.lg",function(){i.core.$outer.find(".lg-current .lg-image").length&&(o+=i.core.s.scale,s())}),e("#lg-actual-size").on("click.lg",function(e){a(e,i.core.$slide.eq(i.core.index).find(".lg-image"),i.core.index,!0)}),i.core.$el.on("onBeforeSlide.lg.tm",function(){o=1,i.resetZoom()}),i.core.isTouch||i.zoomDrag(),i.core.isTouch&&i.zoomSwipe()},n.prototype.resetZoom=function(){this.core.$outer.removeClass("lg-zoomed"),this.core.$slide.find(".lg-img-wrap").removeAttr("style data-x data-y"),this.core.$slide.find(".lg-image").removeAttr("style data-scale"),this.pageX=e(t).width()/2,this.pageY=e(t).height()/2+e(t).scrollTop()},n.prototype.zoomSwipe=function(){var e=this,t={},i={},n=!1,o=!1,r=!1;e.core.$slide.on("touchstart.lg",function(i){if(e.core.$outer.hasClass("lg-zoomed")){var n=e.core.$slide.eq(e.core.index).find(".lg-object");r=n.outerHeight()*n.attr("data-scale")>e.core.$outer.find(".lg").height(),o=n.outerWidth()*n.attr("data-scale")>e.core.$outer.find(".lg").width(),(o||r)&&(i.preventDefault(),t={x:i.originalEvent.targetTouches[0].pageX,y:i.originalEvent.targetTouches[0].pageY})}}),e.core.$slide.on("touchmove.lg",function(s){if(e.core.$outer.hasClass("lg-zoomed")){var a,l,c=e.core.$slide.eq(e.core.index).find(".lg-img-wrap");s.preventDefault(),n=!0,i={x:s.originalEvent.targetTouches[0].pageX,y:s.originalEvent.targetTouches[0].pageY},e.core.$outer.addClass("lg-zoom-dragging"),l=r?-Math.abs(c.attr("data-y"))+(i.y-t.y):-Math.abs(c.attr("data-y")),a=o?-Math.abs(c.attr("data-x"))+(i.x-t.x):-Math.abs(c.attr("data-x")),(Math.abs(i.x-t.x)>15||Math.abs(i.y-t.y)>15)&&c.css({left:a+"px",top:l+"px"})}}),e.core.$slide.on("touchend.lg",function(){e.core.$outer.hasClass("lg-zoomed")&&n&&(n=!1,e.core.$outer.removeClass("lg-zoom-dragging"),e.touchendZoom(t,i,o,r))})},n.prototype.zoomDrag=function(){var i=this,n={},o={},r=!1,s=!1,a=!1,l=!1;i.core.$slide.on("mousedown.lg.zoom",function(t){var o=i.core.$slide.eq(i.core.index).find(".lg-object");l=o.outerHeight()*o.attr("data-scale")>i.core.$outer.find(".lg").height(),a=o.outerWidth()*o.attr("data-scale")>i.core.$outer.find(".lg").width(),i.core.$outer.hasClass("lg-zoomed")&&e(t.target).hasClass("lg-object")&&(a||l)&&(t.preventDefault(),n={x:t.pageX,y:t.pageY},r=!0,i.core.$outer.scrollLeft+=1,i.core.$outer.scrollLeft-=1,i.core.$outer.removeClass("lg-grab").addClass("lg-grabbing"))}),e(t).on("mousemove.lg.zoom",function(e){if(r){var t,c,u=i.core.$slide.eq(i.core.index).find(".lg-img-wrap");s=!0,o={x:e.pageX,y:e.pageY},i.core.$outer.addClass("lg-zoom-dragging"),c=l?-Math.abs(u.attr("data-y"))+(o.y-n.y):-Math.abs(u.attr("data-y")),t=a?-Math.abs(u.attr("data-x"))+(o.x-n.x):-Math.abs(u.attr("data-x")),u.css({left:t+"px",top:c+"px"})}}),e(t).on("mouseup.lg.zoom",function(e){r&&(r=!1,i.core.$outer.removeClass("lg-zoom-dragging"),!s||n.x===o.x&&n.y===o.y||(o={x:e.pageX,y:e.pageY},i.touchendZoom(n,o,a,l)),s=!1),i.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")})},n.prototype.touchendZoom=function(e,t,i,n){var o=this,r=o.core.$slide.eq(o.core.index).find(".lg-img-wrap"),s=o.core.$slide.eq(o.core.index).find(".lg-object"),a=-Math.abs(r.attr("data-x"))+(t.x-e.x),l=-Math.abs(r.attr("data-y"))+(t.y-e.y),c=(o.core.$outer.find(".lg").height()-s.outerHeight())/2,u=Math.abs(s.outerHeight()*Math.abs(s.attr("data-scale"))-o.core.$outer.find(".lg").height()+c),d=(o.core.$outer.find(".lg").width()-s.outerWidth())/2,h=Math.abs(s.outerWidth()*Math.abs(s.attr("data-scale"))-o.core.$outer.find(".lg").width()+d);(Math.abs(t.x-e.x)>15||Math.abs(t.y-e.y)>15)&&(n&&(-u>=l?l=-u:l>=-c&&(l=-c)),i&&(-h>=a?a=-h:a>=-d&&(a=-d)),n?r.attr("data-y",Math.abs(l)):l=-Math.abs(r.attr("data-y")),i?r.attr("data-x",Math.abs(a)):a=-Math.abs(r.attr("data-x")),r.css({left:a+"px",top:l+"px"}))},n.prototype.destroy=function(){var i=this;i.core.$el.off(".lg.zoom"),e(t).off(".lg.zoom"),i.core.$slide.off(".lg.zoom"),i.core.$el.off(".lg.tm.zoom"),i.resetZoom(),clearTimeout(i.zoomabletimeout),i.zoomabletimeout=!1},e.fn.lightGallery.modules.zoom=n}(jQuery,window,document);